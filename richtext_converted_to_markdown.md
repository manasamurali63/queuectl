Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML````   Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML``   # QueueCTL – Background Job Queue System  ## Tech Stack  **Language:** Python 3.12    **Storage:** JSON File Persistence    **Libraries Used:** `argparse`, `subprocess`, `multiprocessing`, `json`, `os`, `time`, `uuid`  ---  ## Objective  Build a CLI-based background job queue system called **`queuectl`**.    This system manages background jobs with worker processes, automatically retries failed jobs using **exponential backoff**, and maintains a **Dead Letter Queue (DLQ)** for permanently failed jobs.    The design focuses on reliability, persistence, and simple CLI-based control.  ---  ## Problem Overview  This project implements a minimal, production-grade job queue system that supports:  - Enqueuing and managing background jobs    - Running multiple worker processes concurrently    - Retrying failed jobs automatically    - Exponential backoff for retry delays    - Moving permanently failed jobs to a **Dead Letter Queue (DLQ)**    - Persistent job storage using JSON across restarts    - CLI interface for all operations    ---  ## Job Specification  Each job includes the following fields:  ```json  {    "id": "unique-job-id",    "command": "echo 'Hello World'",    "state": "pending",    "attempts": 0,    "max_retries": 3,    "created_at": "2025-11-04T10:30:00Z",    "updated_at": "2025-11-04T10:30:00Z"  }   ``  Setup Instructions — How to Run Locally ---------------------------------------  ### Prerequisites  *   Python 3.10 or higher      *   Git installed on your system       ### Steps  #### 1. Clone the repository  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   git clone https://github.com/manasamurali63/queuectl.git  cd queuectl   `  #### 2. Run commands using Python  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   python queue_ctl.py --help   `  > **Note:** No external libraries are required since the implementation only uses Python’s standard library.  Usage Examples — CLI Commands with Example Outputs --------------------------------------------------  ### Enqueue a Job  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   python queue_ctl.py enqueue --command "echo hello && exit 0"   `  **Output:**  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   Enqueued: 5e11e3dc2def47df82472cd2e8693b06   `  ### Start Multiple Workers  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   python queue_ctl.py worker start --count 2   `  **Output:**  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   Started worker pid: 8728  Started worker pid: 10956  [worker-44758] picked job 5e11e3dc2def47df82472cd2e8693b06 -> echo hello && exit 0  hello  [worker-44758] job 5e11e3dc2def47df82472cd2e8693b06 completed.   `  ### Check Status  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   python queue_ctl.py status   `  **Output:**  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   --- STATUS ---  Pending: 0  Processing: 0  Failed (DLQ): 0  Active workers (known): 2  ----------------   `  ### View Dead Letter Queue  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   python queue_ctl.py dlq list   `  **Output:**  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   {    "id": "fe6ad23dd7274bd6a699ac08fcadde87",    "command": "exit 1",    "state": "dead",    "attempts": 3,    "max_retries": null,    "created_at": "2025-11-09T04:27:41Z",    "updated_at": "2025-11-09T04:27:42Z"  }   `  ### Retry a Job from DLQ  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   python queue_ctl.py dlq retry fe6ad23dd7274bd6a699ac08fcadde87   `  ### Stop All Workers  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   python queue_ctl.py worker stop   `  **Output:**  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   Stopping pid 8728  SUCCESS: The process with PID 8728 has been terminated.  Stopping pid 10956  SUCCESS: The process with PID 10956 has been terminated.  Workers stopped.   `  Architecture Overview — Job Lifecycle, Data Persistence, Worker Logic ---------------------------------------------------------------------  ### Job Lifecycle  **StateDescription**pendingWaiting to be processedprocessingCurrently executingcompletedSuccessfully executedfailedFailed but will retrydeadPermanently failed, moved to DLQ  ### Data Persistence  *   Jobs are stored in a JSON file (jobs.json) in the project directory.      *   Each change in job state is saved immediately to ensure persistence across restarts.      *   The DLQ is also persisted in the same JSON file for recovery.       ### Worker Logic  *   Workers are created as separate processes using Python’s multiprocessing module.      *   Each worker continuously polls the queue for available jobs.      *   The worker executes the job command using the subprocess module.      *   Success or failure is determined by the process exit code.      *   Failed jobs are retried using **exponential backoff** (delay = base ^ attempts).      *   When the retry limit is reached, the job is moved to the **Dead Letter Queue (DLQ)**.      *   Workers can be started or stopped gracefully from the CLI.       Assumptions & Trade-offs — Decisions Made and Simplifications -------------------------------------------------------------  ### Storage  *   JSON file is used for persistence instead of a database to keep the project lightweight.       ### Retries  *   Default maximum retries: 3      *   Exponential backoff base value: 2 seconds       ### Worker Management  *   Multiple workers can run in parallel, but all run locally on the same system.      *   File-level locking is used for concurrency control.       ### Simplifications  *   Priority queues, scheduled jobs, and web dashboards are not implemented.      *   Configuration and state files are stored locally.       Testing Instructions — How to Verify Functionality --------------------------------------------------  ### Test 1: Successful Job  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   python queue_ctl.py enqueue --command "echo test && exit 0"  python queue_ctl.py worker start --count 1   `  **Expected Result:** Job completes successfully and shows as “completed”.  ### Test 2: Failed Job with Retries  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   python queue_ctl.py enqueue --command "exit 1"  python queue_ctl.py worker start --count 1   `  **Expected Result:** Job fails, retries 3 times with increasing delays (1s, 2s, 4s), then moves to DLQ.  ### Test 3: Persistence  *   Enqueue jobs and start workers.      *   Stop the script or close the terminal.      *   Re-run:       Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   python queue_ctl.py status   `  **Expected Result:** Job states are still available after restart.  ### Test 4: Retry from DLQ  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`python queue_ctl.py dlq list  python queue_ctl.py dlq retry`   **Expected Result:** The job is re-enqueued and retried again.  ### Test 5: Graceful Worker Stop  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML`   python queue_ctl.py worker stop   `  **Expected Result:** Workers finish their current job before shutting down.  Plain textANTLR4BashCC#CSSCoffeeScriptCMakeDartDjangoDockerEJSErlangGitGoGraphQLGroovyHTMLJavaJavaScriptJSONJSXKotlinLaTeXLessLuaMakefileMarkdownMATLABMarkupObjective-CPerlPHPPowerShell.propertiesProtocol BuffersPythonRRubySass (Sass)Sass (Scss)SchemeSQLShellSwiftSVGTSXTypeScriptWebAssemblyYAMLXML   ````